@using System.Numerics
@model IEnumerable<OrderProductModel>

<div class="container-fluid">
    <div class="d-flex mb-3 mb-lg-4 align-items-center">
        <div class="mr-auto d-none d-lg-block">
            <div class="d-flex flex-wrap align-items-center">
                <h3 class="text-black font-w600 mb-0 fs-28 mr-5">#@Model.FirstOrDefault()?.FOrderNo</h3>
                <input id="orderNoInput" type="hidden" value="@Model.FirstOrDefault()?.FOrderNo">
                <div class="d-flex">
                    <a class="mb-0 text-black font-w500 fs-18" href="#">Orders / </a>
                    <a class="mb-0 font-w400 fs-18 ml-2" href="#" > Order Detaills </a>
                </div>
            </div>
        </div>
        <div class="d-flex align-items-center">
                <div class="btn btn-success d-block text-white rounded-0" onclick="cooked()">
                    <svg class="mr-2" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14.7576 15.8041H16.5252C16.4832 16.2551 16.1031 16.6094 15.6414 16.6094C15.1797 16.6094 14.7995 16.2551 14.7576 15.8041ZM8.32598 16.6094C8.78766 16.6094 9.16781 16.2551 9.20977 15.8041H7.4422C7.48411 16.2551 7.86427 16.6094 8.32598 16.6094ZM6.11719 14.6791H13.0004V8.56444V7.39064H6.11719V14.6791ZM24 12C24 18.6168 18.6168 24 12 24C5.38317 24 0 18.6168 0 12C0 5.38317 5.38317 0 12 0C18.6168 0 24 5.38317 24 12ZM19.0078 11.7096C19.0078 11.5545 18.9782 11.4095 18.9172 11.2662L17.844 8.73923C17.6538 8.29134 17.2027 8.00194 16.695 8.00194H14.1254V6.82814C14.1254 6.5175 13.8735 6.26564 13.5629 6.26564H5.55469C5.24405 6.26564 4.99219 6.5175 4.99219 6.82814V15.2416C4.99219 15.5523 5.24405 15.8041 5.55469 15.8041H6.31509C6.35873 16.8758 7.24378 17.7344 8.32598 17.7344C9.40819 17.7344 10.2932 16.8758 10.3369 15.8041H13.6305C13.6741 16.8758 14.5592 17.7344 15.6414 17.7344C16.7236 17.7344 17.6086 16.8758 17.6523 15.8041H18.4453C18.756 15.8041 19.0078 15.5523 19.0078 15.2416V11.7096ZM16.8086 9.17906C16.7923 9.14067 16.7392 9.12694 16.695 9.12694H14.1254V14.6791H17.8828V11.7096C17.8828 11.709 17.8828 11.7087 17.8829 11.7086C17.8825 11.7077 17.8822 11.7069 17.8818 11.706L16.8086 9.17906Z" fill="white"/>
                    </svg>
                    Delivered
                </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xl-12">
            <div class="row">
                <div class="col-xl-12">
                    <div class="card">
                        <div class="card-body p-0">
                            <div class="table-responsive order-list card-table">
                                <table class="table items-table table-responsive-md">
                                    <tbody>
                                    <tr class="bg-primary">
                                        <th class="text-black font-w500 fs-20">Items</th>
                                        <th style="width:10%;" class="text-black font-w500 fs-20">Qty</th>
                                        <th style="width:10%;" class="text-black font-w500 fs-20">Price</th>
                                        <th class="my-0 text-black font-w500 fs-20 wspace-no d-md-none d-lg-table-cell">Total Price</th>
                                        <th></th>
                                    </tr>
                                    
                                    @if (Model is not null)
                                    {
                                        foreach (OrderProductModel oproduct in Model)
                                        {
                                            BigInteger totalPrice = oproduct.FAmount * oproduct.ProductPrice / 100;
                                            
                                            <tr>
                                                <td>
                                                    <div class="media">
                                                        <a href=""><img class="mr-3 img-fluid rounded" src="/customer/@oproduct.ProductImgPath" alt="DexignZone" width="87px" height="87px" ></a>
                                                        <div class="media-body">
                                                            <small class="mt-0 mb-1 font-w500"><a class="text-primary" href="javascript:void(0);">MAIN COURSE</a></small>
                                                            <h5 class="mt-0 mb-2 mb-sm-3"><a class="text-black" href="ecom-product-detail.html">@oproduct.ProductName</a></h5>
                                                            <div class="star-review d-flex fs-14">
                                                                <i class="fa fa-star text-orange"></i>
                                                                <i class="fa fa-star text-orange"></i>
                                                                <i class="fa fa-star text-orange"></i>
                                                                <i class="fa fa-star text-gray"></i>
                                                                <i class="fa fa-star text-gray"></i>
                                                                <span class="ml-3 text-dark">(454 revies)</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>
                                                    <h4 class="my-0  font-w600">@(oproduct.FAmount)x</h4>
                                                </td>
                                                <td>
                                                    <h4 class="my-0  font-w600">$@(oproduct.ProductPrice/100)</h4>
                                                </td>
                                                <td class="d-md-none d-lg-table-cell">
                                                    <h4 class="my-0  font-w600">$@totalPrice</h4>
                                                </td>
                                            </tr>
                                        }
                                    }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-12">
                    <div class="card">
                        <div class="widget-timeline-icon">
                            <ul class="timeline">
                                <li>
                                    <div class="icon bg-primary"></div>
                                    <a class="timeline-panel text-muted" href="#">
                                        <h4 class="mb-2 mt-0">Order Created</h4>
                                    </a>
                                </li>

                                @{
                                    // Pay success and no to cook
                                    if("1" == Model.FirstOrDefault()?.PayStatus
                                    && "0" == Model.FirstOrDefault()?.CookingStatus) {
                                        <li>
                                            <div class="icon bg-primary"></div>
                                            <a class="timeline-panel text-muted" href="#">
                                                <h4 class="mb-2 mt-0">Payment Success</h4>
                                            </a>
                                        </li>
                                        <li class="border-success">
                                            <div class="icon bg-primary"></div>
                                            <a class="timeline-panel text-muted" href="#">
                                                <h4 class="mb-2 mt-0">On Cooking</h4>
                                            </a>
                                        </li>
                                        <li>
                                            <div class="icon bg-success"></div>
                                            <a class="timeline-panel text-muted" href="#">
                                                <h4 class="mb-2 mt-0">Order Delivered</h4>
                                            </a>
                                        </li>
                                    }else if("1" == Model.FirstOrDefault()?.PayStatus
                                             && "1" == Model.FirstOrDefault()?.CookingStatus) {
                                        <li>
                                            <div class="icon bg-primary"></div>
                                            <a class="timeline-panel text-muted" href="#">
                                                <h4 class="mb-2 mt-0">Payment Success</h4>
                                            </a>
                                        </li>
                                        <li>
                                            <div class="icon bg-primary"></div>
                                            <a class="timeline-panel text-muted" href="#">
                                                <h4 class="mb-2 mt-0">On Cooking</h4>
                                            </a>
                                        </li>
                                        <li>
                                            <div class="icon bg-primary"></div>
                                            <a class="timeline-panel text-muted" href="#">
                                                <h4 class="mb-2 mt-0">Order Delivered</h4>
                                            </a>
                                        </li>
                                    }else if ("0" == Model.FirstOrDefault()?.PayStatus)
                                    {
                                        <li class="border-success">
                                            <div class="icon bg-primary"></div>
                                            <a class="timeline-panel text-muted" href="#">
                                                <h4 class="mb-2 mt-0">Payment Success</h4>
                                            </a>
                                        </li>
                                        <li class="border-success">
                                            <div class="icon bg-success"></div>
                                            <a class="timeline-panel text-muted" href="#">
                                                <h4 class="mb-2 mt-0">On Cooking</h4>
                                            </a>
                                        </li>
                                        <li>
                                            <div class="icon bg-success"></div>
                                            <a class="timeline-panel text-muted" href="#">
                                                <h4 class="mb-2 mt-0">Order Delivered</h4>
                                            </a>
                                        </li>
                                    }
                                }
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
				
<script type="text/javascript">
	function cooked() {
		let orderNo = $("#orderNoInput").val();

		let tempform = document.createElement("form");

		tempform.action = "update-order-cooking-status";
		tempform.method = "post";
		tempform.style.display="none"
		tempform.enctype = "application/x-www-form-urlencoded;charset=utf-8";

		let opt = document.createElement("input");
		opt.name = "orderNo";
		opt.value = orderNo;
		tempform.appendChild(opt);

		let opt2 = document.createElement("input");
		opt2.name = "mode";
		opt2.value = "1";
		tempform.appendChild(opt2);

		let opt3 = document.createElement("input");
		opt3.type = "submit";
		tempform.appendChild(opt3);
		document.body.appendChild(tempform);
		tempform.submit();
		document.body.removeChild(tempform);
	}
</script>